\subsection{Forward modelling and non-uniqueness in potential field methods}
\begin{tcolorbox}[enhanced jigsaw,breakable,pad at break*=1mm,
  colback=blue!5!white,colframe=burgundy,title=Matlab (or Python),
  watermark color=white]
  Basic programming (Matlab/Python/R) will  likely be part of your study experience when you move to MSc level courses. It is a useful skill to have, but here we do not cover any introduction. What we do is that we start with codes that need  little user interaction to give you a feel for what programming can be about. In order to run this exercise you should have a working Matlab version on your Computer, please follow the installation instructions provided by the ZDV. Alternatively, we can also give you a laptop for the joint meeting.
\end{tcolorbox}
\label{Sec:GravityForwardModelling}
In order to predict how any kind of object will appear in a gravity survey, we need to solve the volume integral:
$$
 \vec{g}(r) = G\int \frac{1}{r^3} \rho(r) \vec{r} dV 
$$
which simplifies slightly to:
$$
 g_z(r) = G\int \frac{1}{r^2} \cos(\phi)\rho(r) dV = G\int \frac{z}{r^3} \rho(r) dV
$$
because often only the vertical component is of interest (same as in Ex 1.1).
However, the problem remains complicated as the integration bounds depend on the object's geometry and the integral needs to be solved for every $r$ along the gravimetry profile. Some solutions for special shapes you already know (e.g.sphere, bouger plate). Here we use the solution for a rectangular prism which fortunately others have already calculated for us (\textit{Naggy 1966, Geophysics VOL. XXX, SO. 2}). Using this solution, we can build up more complicated shapes out of individual prisms.

In the specific model applied individual prisms are defined with their widths in the horizontal (wx, wy) and the vertical (wz), together with the positions in the subsurface. The key is that the position coordinates (dx1, dx2, dy1, dy2, dz1, dz2) need to be prescribed relative to the measurement position which changes along the profile. The expected anomaly is then calculated based on the analytical solution.
\begin{enumerate}[label=(\alph*)]

  \item This exercises uses Matlab. However, only minimal Matlab skills are required to follow along. Download the files \textit{Gravimetry02\_ForwardModelling.m} and \textit{gravprism.m} into the same folder on your computer. Check out case 1 which simulates a rectangular object in the subsurface. Change it's location and size so that you know what is going on.

  \item Switch to case 2. This one treats the combined effect of two prisms. See what's different compared to case 1. Play around with positions to see what is going on.

  \item Switch to case 3. This one treats the individual effects of two prisms meaning that it doesn't sum them up. This one will not run until you fill out the parts marked with XXX. Use this case to illustrate that multiple situations in the sub-surface (e.g. a shallow prism with low density contrast vs. a lower prism with larger density contrast) can result in similar anomalies. This is an important finding. Forward models are often not unique, and therefore your interpretation won't be either. This situation occurs in many geophysical situations. Remember that.
\end{enumerate}
\ifanswers
\begin{tcolorbox}[enhanced jigsaw,breakable,pad at break*=1mm,
  colback=blue!5!white,colframe=babyblueeyes,title=Solutions,
  watermark color=white]
  \lstinputlisting[language=matlab]{../../Src/Gravimetry/PrismForwardModel/GravForwardModelPrismRD.m}
\end{tcolorbox}
\fi